{% comment %}
  Supervision renderer â€” clean CV style + PDF-link aware.
  Works with:
    - entries as a list
    - OR entries as an object with `contents`
  Expected entry keys (your YAML):
    - title, institution, year, description (often <a href="...">...</a>)
{% endcomment %}

{% assign list = entries %}
{% if entries.contents %}
  {% assign list = entries.contents %}
{% endif %}

<ul class="card-text font-weight-light list-group list-group-flush">
  {% for entry in list %}
    <li class="list-group-item">
      <div class="row">
        {% capture item_date %}
          {% if entry.year %}{{ entry.year }}{% elsif entry.date %}{{ entry.date }}{% endif %}
        {% endcapture %}

        {% if item_date != '' %}
          <div class="col-xs-2 col-sm-2 col-md-2 text-center">
            <span class="badge font-weight-bold danger-color-dark text-uppercase align-middle" style="min-width:75px">
              {{ item_date }}
            </span>
          </div>
          <div class="col-xs-10 col-sm-10 col-md-10">
        {% else %}
          <div class="col-md-12">
        {% endif %}

            {% capture item_title %}
              {% if entry.title %}{{ entry.title }}{% elsif entry.name %}{{ entry.name }}{% endif %}
            {% endcapture %}
            {% if item_title != '' %}
              <h6 class="title font-weight-bold ml-1 ml-md-2">{{ item_title }}</h6>
            {% endif %}

            {% if entry.institution %}
              <div class="ml-1 ml-md-2">{{ entry.institution }}</div>
            {% endif %}

            {% comment %} Render description (PDF link-aware) {% endcomment %}
            {% if entry.description %}
              {% assign desc = entry.description %}

              {% if desc contains 'href="' %}
                {% assign href_part = desc | split: 'href="' | last %}
                {% assign href = href_part | split: '"' | first %}

                {% assign text_part = desc | split: '>' | last %}
                {% assign link_text = text_part | split: '</a' | first %}

                {% comment %}
                  Make internal links work with Jekyll baseurl via relative_url.
                  If it's absolute (contains ://), use as-is.
                {% endcomment %}
                {% if href contains '://' %}
                  {% assign final_href = href %}
                {% else %}
                  {% assign final_href = href | relative_url %}
                {% endif %}

                <div class="ml-1 ml-md-2">
                  <a href="{{ final_href }}" target="_blank" rel="noopener noreferrer">
                    <i class="fa-solid fa-file-pdf"></i>
                    {{ link_text }}
                  </a>
                </div>
              {% else %}
                <div class="ml-1 ml-md-2">{{ desc }}</div>
              {% endif %}

            {% elsif entry.summary %}
              <div class="ml-1 ml-md-2">{{ entry.summary }}</div>
            {% endif %}

          </div>
      </div>
    </li>
  {% endfor %}
</ul>
